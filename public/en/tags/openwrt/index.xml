<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Openwrt on ScienceChronicle</title>
    <link>http://localhost:1313/en/tags/openwrt/</link>
    <description>Recent content in Openwrt on ScienceChronicle</description>
    <generator>Hugo</generator>
    <language>en</language>
    <lastBuildDate>Wed, 21 Aug 2024 03:58:40 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/en/tags/openwrt/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Using SQLITE database with Perl on OpenWRT</title>
      <link>http://localhost:1313/en/article/using-sqlite-with-perl-on-openwrt-no-dbd/</link>
      <pubDate>Wed, 21 Aug 2024 03:58:40 +0000</pubDate>
      <guid>http://localhost:1313/en/article/using-sqlite-with-perl-on-openwrt-no-dbd/</guid>
      <description>&lt;p&gt;This article discusses using an SQLite database with Perl on the OpenWRT &lt;code&gt;openwrt-23.05 branch (git-23.233.52805-dae2684)&lt;/code&gt;. We aim to use an SQLite database with Perl.&lt;/p&gt;&#xA;&lt;p&gt;First, we need to install the &lt;code&gt;DBI&lt;/code&gt; module and then find and install &lt;code&gt;DBD&lt;/code&gt; for SQLite. Let&amp;rsquo;s examine the directory of Perl modules available on OpenWRT: &lt;a href=&#34;https://openwrt.org/packages/index/languages---perl&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Perl Modules on OpenWRT&lt;/a&gt;&#xA;.&lt;/p&gt;&#xA;&lt;p&gt;One can see that the &lt;code&gt;DBI&lt;/code&gt; module is present: &lt;a href=&#34;https://openwrt.org/packages/pkgdata/perl-dbi&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perl-dbi&lt;/a&gt;&#xA;. After installing it, let&amp;rsquo;s check which &lt;code&gt;DBD&lt;/code&gt; modules are included:&lt;/p&gt;</description>
    </item>
    <item>
      <title>Understanding Cronjob Self-Deletion: Behavior and Implications When Restarting Cron Service on OpenWRT</title>
      <link>http://localhost:1313/en/article/openwrt-understanding-cronjob-self-deletion/</link>
      <pubDate>Sun, 18 Aug 2024 01:58:40 +0000</pubDate>
      <guid>http://localhost:1313/en/article/openwrt-understanding-cronjob-self-deletion/</guid>
      <description>&lt;h3 id=&#34;intro&#34;&gt;Intro&lt;/h3&gt;&#xA;&lt;p&gt;The article addresses the question: Will a cronjob complete its run if it removes itself from the crontab and restarts the cron service? We conducted tests on OpenWRT version 23.05.3 240325 to find out.&lt;/p&gt;&#xA;&lt;h3 id=&#34;test&#34;&gt;Test&lt;/h3&gt;&#xA;&lt;p&gt;To answer this question, we wrote a short Perl script, &lt;code&gt;b.pl&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#6272a4&#34;&gt;#!/usr/bin/perl&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff79c6&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;Start\n&amp;#34;&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;`sed -i /b.pl/d /etc/crontabs/root`&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff79c6&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;Removed crontab entry\n&amp;#34;&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;`service cron restart`&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff79c6&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;Restarted cron service\n&amp;#34;&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8be9fd;font-style:italic&#34;&gt;sleep&lt;/span&gt;(&lt;span style=&#34;color:#bd93f9&#34;&gt;10&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff79c6&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;Slept 10 sec and now exiting\n&amp;#34;&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We added the following crontab entry using &lt;code&gt;crontab -e&lt;/code&gt;:&lt;/p&gt;</description>
    </item>
    <item>
      <title>OpenWRT with WireGuard server which is connected through OpenVPN</title>
      <link>http://localhost:1313/en/article/openwrt-wg-server-through-vpn/</link>
      <pubDate>Thu, 18 Jul 2024 01:58:40 +0000</pubDate>
      <guid>http://localhost:1313/en/article/openwrt-wg-server-through-vpn/</guid>
      <description>&lt;p&gt;We setup a wireguard server on an OpenWRT router. We generate a setup file for the client. The wireguard server itself we connect through a VPN. The VPN itself can be socked through TOR (we don&amp;rsquo;t discuss this in the article).&lt;/p&gt;&#xA;&lt;h2 id=&#34;generate-keys&#34;&gt;Generate keys&lt;/h2&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8be9fd;font-style:italic&#34;&gt;umask&lt;/span&gt; &lt;span style=&#34;color:#8be9fd;font-style:italic&#34;&gt;go&lt;/span&gt;&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;wg genkey | tee wgserver.key | wg pubkey &amp;gt; wgserver.pub&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;wg genkey | tee wgclient.key | wg pubkey &amp;gt; wgclient.pub&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;wg genpsk &amp;gt; wgclient.psk&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;setup-wireguard-server&#34;&gt;Setup wireguard server&lt;/h2&gt;&#xA;&lt;p&gt;Note, wireguard server is actually a kernel module and there is no a special application to be run. The wireguard module exposes interface to &lt;code&gt;ip link&lt;/code&gt; with which one can create a device of type &lt;code&gt;wireguard&lt;/code&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>OpenWRT under hood</title>
      <link>http://localhost:1313/en/article/openwrt-under-the-hood/</link>
      <pubDate>Mon, 08 Jul 2024 01:58:40 +0000</pubDate>
      <guid>http://localhost:1313/en/article/openwrt-under-the-hood/</guid>
      <description>&lt;h2 id=&#34;wireless-configuration&#34;&gt;Wireless configuration&lt;/h2&gt;&#xA;&lt;p&gt;Behind the scenes, UCI (Unified Configuration Interface) in OpenWRT uses various command-line utilities and services to apply the wireless configurations defined in &lt;code&gt;/etc/config/wireless&lt;/code&gt;. Here are some key components and commands involved in this process:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;netifd&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The &lt;code&gt;netifd&lt;/code&gt; (network interface daemon) is responsible for managing network interfaces in OpenWRT. It handles the configuration of interfaces based on the UCI configuration files.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;hostapd&lt;/strong&gt; and &lt;strong&gt;wpa_supplicant&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;OpenWRT typically uses &lt;code&gt;hostapd&lt;/code&gt; for managing Access Point (AP) interfaces and &lt;code&gt;wpa_supplicant&lt;/code&gt; for client interfaces. These services are controlled and configured by &lt;code&gt;netifd&lt;/code&gt; based on the UCI settings.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;iw and ip commands&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;netifd&lt;/code&gt; uses &lt;code&gt;iw&lt;/code&gt; to configure wireless devices and interfaces. It also uses &lt;code&gt;ip&lt;/code&gt; to manage network interfaces at a lower level.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;example-workflow&#34;&gt;Example Workflow&lt;/h3&gt;&#xA;&lt;p&gt;When you configure an SSID in &lt;code&gt;/etc/config/wireless&lt;/code&gt; and run &lt;code&gt;wifi reload&lt;/code&gt;, the following steps typically occur:&lt;/p&gt;</description>
    </item>
    <item>
      <title>Install NYX on OpenWRT</title>
      <link>http://localhost:1313/en/article/install-nyx-on-openwrt/</link>
      <pubDate>Tue, 04 Jun 2024 02:58:40 +0000</pubDate>
      <guid>http://localhost:1313/en/article/install-nyx-on-openwrt/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://nyx.torproject.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NYX&lt;/a&gt;&#xA; is a monitoring utility for TOR. It connects to Tor&amp;rsquo;s control port so to make it work we should define the control port in &lt;code&gt;/etc/tor/torrc&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#6272a4&#34;&gt;# File: /etc/tor/torrc&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ControlPort &lt;span style=&#34;color:#bd93f9&#34;&gt;9051&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Install NYX on &lt;a href=&#34;https://openwrt.org/toh/asus/tuf-ax4200&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;OpenWRT&lt;/a&gt;&#xA; version 23.05.3 r23809-234f1a2efa with the following commands:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;opkg update&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;opkg install nyx&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;When running, we get into an error:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;nyx&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Traceback &lt;span style=&#34;color:#ff79c6&#34;&gt;(&lt;/span&gt;most recent call last&lt;span style=&#34;color:#ff79c6&#34;&gt;)&lt;/span&gt;:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  File &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;/usr/bin/nyx&amp;#34;&lt;/span&gt;, line 8, in &amp;lt;module&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sys.exit&lt;span style=&#34;color:#ff79c6&#34;&gt;(&lt;/span&gt;main&lt;span style=&#34;color:#ff79c6&#34;&gt;())&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;             ^^^^^^&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  File &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;/usr/lib/python3.11/site-packages/nyx/__init__.py&amp;#34;&lt;/span&gt;, line 176, in main&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  File &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;/usr/lib/python3.11/site-packages/stem/util/conf.py&amp;#34;&lt;/span&gt;, line 288, in wrapped&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;AttributeError: module &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#39;inspect&amp;#39;&lt;/span&gt; has no attribute &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#39;getargspec&amp;#39;&lt;/span&gt;. Did you mean: &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#39;getargs&amp;#39;&lt;/span&gt;?&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To solve that problem, we proceed as follows:&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
